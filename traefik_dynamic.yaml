#traefik_dynamic.yaml
http:
  routers:
    # api:
    #   rule: "Host(`monitor.dependencyinspection`)"
    #   entryPoints:
    #     - websecure
    #   middlewares:
    #     - simpleAuth
    #   service: "api@internal"
    #   tls:
    #     certResolver: lets-encrypt
    #
    frontend-service:
      rule: "Host(`dependencyinspection.com`)"
      entryPoints:
        - websecure
      service: "frontend-service"  
      tls:
        certResolver: myresolver
        domains:
          - main: "dependencyinspection.com"
            sans:
              - "www.dependencyinspection.com"
    backend-service:
      rule: "Host(`dependencyinspection.com`) && PathPrefix(`/api`)"
      entryPoints:
        - websecure
      service: "backend-service"  
      tls:
        certResolver: myresolver
        domains:
          - main: "dependencyinspection.com"
            sans:
              - "www.dependencyinspection.com"
  middlewares:
    strip-api-prefix:
      stripPrefix:
        prefixes:
          - "/api"
#   middlewares:
#     simpleAuth:
#       basicAuth:
#         users:
#           - "admin:something here"
  services:
    frontend-service:
      loadbalancer: 
        servers:
          - url: "http://frontend-service:8081"
    backend-service:
      loadbalancer: 
        servers:
          - url: "http://backend-service:5001"
      middlewares:
        - strip-api-prefix
    neo4j-service:
      loadbalancer: 
        servers:
          - url: "http://neo4j-service:7687"

